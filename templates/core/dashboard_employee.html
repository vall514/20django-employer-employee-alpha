{% extends 'partials/base.html' %}
{% block title %}Employee Dashboard{% endblock %}
{% block content %}
<h2 class="mb-4">Welcome, {{ user.first_name }} {{ user.last_name }}</h2>
<div class="row">
    <div class="col-12">
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-primary text-white">Your Leave Requests</div>
            <div class="card-body">
                {% if leave_requests %}
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Start Date</th>
                                <th>End Date</th>
                                <th>Reason</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for leave in leave_requests %}
                                <tr>
                                    <td>{{ leave.start_date }}</td>
                                    <td>{{ leave.end_date }}</td>
                                    <td>{{ leave.reason }}</td>
                                    <td>{{ leave.status|title }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p>No leave requests found.</p>
                {% endif %}
                <a href="{% url 'core:leave_request' %}" class="btn btn-primary mt-3">Request Leave</a>
            </div>
        </div>
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-primary text-white">Your Monthly Reports</div>
            <div class="card-body">
                {% if reports %}
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Month</th>
                                <th>Description</th>
                                <th>File</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for report in reports %}
                                <tr>
                                    <td>{{ report.month|date:"F Y" }}</td>
                                    <td>{{ report.description }}</td>
                                    <td>
                                        {% if report.file %}
                                            <a href="{{ report.file.url }}">Download</a>
                                        {% else %}
                                            No file
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p>No reports submitted.</p>
                {% endif %}
                <a href="{% url 'core:monthly_report' %}" class="btn btn-primary mt-3">Submit Report</a>
            </div>
        </div>
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-primary text-white">Your Appraisals</div>
            <div class="card-body">
                {% if appraisals %}
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Score</th>
                                <th>Comments</th>
                                <th>Evaluator</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for appraisal in appraisals %}
                                <tr>
                                    <td>{{ appraisal.date }}</td>
                                    <td>{{ appraisal.score }}</td>
                                    <td>{{ appraisal.comments }}</td>
                                    <td>{{ appraisal.evaluator.username }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p>No appraisals received.</p>
                {% endif %}
            </div>
        </div>
        <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">Your Attendance</div>
            <div class="card-body">
                {% if attendance %}
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Check-In Time</th>
                                <th>Note</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for att in attendance %}
                                <tr>
                                    <td>{{ att.date }}</td>
                                    <td>{{ att.check_in_time }}</td>
                                    <td>{{ att.note|default:"No note" }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p>No attendance records.</p>
                {% endif %}
                <a href="{% url 'core:attendance_check_in' %}" class="btn btn-primary mt-3">Check In</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}